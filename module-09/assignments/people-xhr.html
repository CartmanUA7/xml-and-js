<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="people.css" />
  </head>
  <body>
    <div id="root"></div>
    <script>
      const displayData = (xml) => {
        const rootList = document.getElementById("root");
        const xmlList = xml.getElementsByTagName("row");
        for (let i = 0; i < xmlList.length; i++) {
          const row = xmlList[i];
          const id = row.getAttribute("id");
          const firstName =
            row.getElementsByTagName("first_name")[0].childNodes[0].nodeValue;
          const lastName =
            row.getElementsByTagName("last_name")[0].childNodes[0].nodeValue;
          const email =
            row.getElementsByTagName("email")[0].childNodes[0].nodeValue;
          const gender =
            row.getElementsByTagName("gender")[0].childNodes[0].nodeValue;
          const ip =
            row.getElementsByTagName("ip_address")[0].childNodes[0].nodeValue;
          rootList.innerHTML += `<div class="person"><h1>${id}: ${firstName} ${lastName}</h1>
                                  <a href = "mailto: ${email}">${email}</a></br>
                                  <p>${gender}</p>
                                  <p>IP: ${ip}</p></div>`;
        }
      };

      const xhr = (url, method = "GET") => {
        return new Promise((resolve) => {
          const xhttpr = new XMLHttpRequest();
          xhttpr.onreadystatechange = function () {
            if (this.readyState === 4 && this.status === 200) {
              resolve(this);
            }
          };
          xhttpr.open(method, url, true);
          xhttpr.send();
        });
      };

      xhr("people.xml").then((data) => displayData(data.responseXML));
    </script>
  </body>
</html>
